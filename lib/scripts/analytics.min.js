function iqr(a){return function(b,c){for(var d=b.quartiles[0],e=b.quartiles[2],f=(e-d)*a,c=-1,g=b.length;b[++c]<d-f;);for(;b[--g]>e+f;);return[c,g]}}!function(){function a(a){return[0,a.length-1]}function b(a){return[d3.quantile(a,.25),d3.quantile(a,.5),d3.quantile(a,.75)]}d3.box=function(){function c(a){a.each(function(a,b){a=a.map(h).sort(d3.ascending);var c=d3.select(this),l=a.length,m=a[0],n=a[l-1],o=a.quartiles=j(a),p=i&&i.call(this,a,b),q=p&&p.map(function(b){return a[b]}),r=p?d3.range(0,p[0]).concat(d3.range(p[1]+1,l)):d3.range(l),s=d3.scale.linear().domain(g&&g.call(this,a,b)||[m,n]).range([e,0]),t=this.__chart__||d3.scale.linear().domain([0,1/0]).range(s.range());this.__chart__=s;var u=c.selectAll("line.center").data(q?[q]:[]);u.enter().insert("line","rect").attr("class","center").attr("x1",d/2).attr("y1",function(a){return t(a[0])}).attr("x2",d/2).attr("y2",function(a){return t(a[1])}).style("opacity",1e-6).transition().duration(f).style("opacity",1).attr("y1",function(a){return s(a[0])}).attr("y2",function(a){return s(a[1])}),u.transition().duration(f).style("opacity",1).attr("y1",function(a){return s(a[0])}).attr("y2",function(a){return s(a[1])}),u.exit().transition().duration(f).style("opacity",1e-6).attr("y1",function(a){return s(a[0])}).attr("y2",function(a){return s(a[1])}).remove();var v=c.selectAll("rect.box").data([o]);v.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(a){return t(a[2])}).attr("width",d).attr("height",function(a){return t(a[0])-t(a[2])}).transition().duration(f).attr("y",function(a){return s(a[2])}).attr("height",function(a){return s(a[0])-s(a[2])}),v.transition().duration(f).attr("y",function(a){return s(a[2])}).attr("height",function(a){return s(a[0])-s(a[2])});var w=c.selectAll("line.median").data([o[1]]);w.enter().append("line").attr("class","median").attr("x1",0).attr("y1",t).attr("x2",d).attr("y2",t).transition().duration(f).attr("y1",s).attr("y2",s),w.transition().duration(f).attr("y1",s).attr("y2",s);var x=c.selectAll("line.whisker").data(q||[]);x.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",t).attr("x2",d).attr("y2",t).style("opacity",1e-6).transition().duration(f).attr("y1",s).attr("y2",s).style("opacity",1),x.transition().duration(f).attr("y1",s).attr("y2",s).style("opacity",1),x.exit().transition().duration(f).attr("y1",s).attr("y2",s).style("opacity",1e-6).remove();var y=c.selectAll("circle.outlier").data(r,Number);y.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",d/2).attr("cy",function(b){return t(a[b])}).style("opacity",1e-6).transition().duration(f).attr("cy",function(b){return s(a[b])}).style("opacity",1),y.transition().duration(f).attr("cy",function(b){return s(a[b])}).style("opacity",1),y.exit().transition().duration(f).attr("cy",function(b){return s(a[b])}).style("opacity",1e-6).remove();var z=k||s.tickFormat(8),A=c.selectAll("text.box").data(o);A.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(a,b){return 1&b?6:-6}).attr("x",function(a,b){return 1&b?d:0}).attr("y",t).attr("text-anchor",function(a,b){return 1&b?"start":"end"}).text(z).transition().duration(f).attr("y",s),A.transition().duration(f).text(z).attr("y",s);var B=c.selectAll("text.whisker").data(q||[]);B.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",d).attr("y",t).text(z).style("opacity",1e-6).transition().duration(f).attr("y",s).style("opacity",1),B.transition().duration(f).text(z).attr("y",s).style("opacity",1),B.exit().transition().duration(f).attr("y",s).style("opacity",1e-6).remove()}),d3.timer.flush()}var d=1,e=1,f=0,g=null,h=Number,i=a,j=b,k=null;return c.width=function(a){return arguments.length?(d=a,c):d},c.height=function(a){return arguments.length?(e=a,c):e},c.tickFormat=function(a){return arguments.length?(k=a,c):k},c.duration=function(a){return arguments.length?(f=a,c):f},c.domain=function(a){return arguments.length?(g=null==a?a:d3.functor(a),c):g},c.value=function(a){return arguments.length?(h=a,c):h},c.whiskers=function(a){return arguments.length?(i=a,c):i},c.quartiles=function(a){return arguments.length?(j=a,c):j},c}}(),function(){function a(b,c,d){function e(a){var e=b(a),f=d>e,g=d3.extent(b.range()),h=g[0],i=g[1],j=f?d-h:i-d;return 0==j&&(j=i-h),(f?-1:1)*j*(c+1)/(c+j/Math.abs(e-d))+d}return e.distortion=function(a){return arguments.length?(c=+a,e):c},e.focus=function(a){return arguments.length?(d=+a,e):d},e.copy=function(){return a(b.copy(),c,d)},e.nice=b.nice,e.ticks=b.ticks,e.tickFormat=b.tickFormat,d3.rebind(e,b,"domain","range")}d3.fisheye={scale:function(b){return a(b(),3,0)},circular:function(){function a(a){var b=a.x-g[0],f=a.y-g[1],h=Math.sqrt(b*b+f*f);if(!h||h>=e)return{x:a.x,y:a.y,z:1};var i=c*(1-Math.exp(-h*d))/h*.75+.25;return{x:g[0]+b*i,y:g[1]+f*i,z:Math.min(i,10)}}function b(){return c=Math.exp(f),c=c/(c-1)*e,d=f/e,a}var c,d,e=200,f=2,g=[0,0];return a.radius=function(a){return arguments.length?(e=+a,b()):e},a.distortion=function(a){return arguments.length?(f=+a,b()):f},a.focus=function(b){return arguments.length?(g=b,a):g},b()}}}();var analytics={margin:{top:20,right:20,bottom:90,left:70},scatterPlot:function(a){function b(a){var b=[],c=[];for(i=0;i<a.length;i++){var d=$.map(a[i],function(a){return[a]});-1==c.indexOf(d[0])&&(c.push(d[0]),b.push({key:d[0],values:[]}))}for(j=0;j<c.length;j++)for(k=0;k<a.length;k++){var d=$.map(a[k],function(a){return[a]});d[0]==c[j]&&b[j].values.push({x:parseFloat(d[1]),y:parseFloat(d[2]),size:parseFloat(d[3])})}return b}var c=nv.models.scatterChart().showDistX(!0).showDistY(!0).useVoronoi(!0).color(d3.scale.category10().range());c.xAxis.tickFormat(d3.format(".02f")),c.yAxis.tickFormat(d3.format(".02f")),c.tooltipContent(function(a){return"<p>"+a+"</p>"});var d=d3.select(a.selector),d=d3.select(a.selector);$(a.selector).empty();var e=$(a.selector).width()-analytics.margin.left-analytics.margin.right,f=$(a.selector).height()-analytics.margin.top-analytics.margin.bottom,g=d3.csv.parse(a.data);d.append("svg").attr("display","block").attr("width",e).attr("height",f).datum(b(g)).call(c),nv.utils.windowResize(c.update),c.dispatch.on("stateChange",function(a){JSON.stringify(a)})},boxPlot:function(a){function b(a){var b=[],c=[];for(i=0;i<a.length;i++){var d=$.map(a[i],function(a){return[a]});-1==c.indexOf(d[0])&&c.push(d[0])}for(j=0;j<c.length;j++)for(k=0;k<a.length;k++){var d=$.map(a[k],function(a){return[a]});if(d[0]==c[j]){var e=j,f=parseFloat(d[1]),l=b[e];l?l.push(f):l=b[e]=[f],f>h&&(h=f),g>f&&(g=f)}}return b}var c=d3.select(a.selector);$(a.selector).empty();var d=$(a.selector).width()-analytics.margin.left-analytics.margin.right,e=$(a.selector).height()-analytics.margin.top-analytics.margin.bottom,f=40,g=1/0,h=-1/0,l=d3.csv.parse(a.data),m=b(l),n=d/m.length-2*f;n>100&&(n=100);var o=d3.box().whiskers(iqr(1.5)).width(n).height(e-analytics.margin.top-analytics.margin.bottom);o.domain([g,h]);c.selectAll("svg").attr("display","none").append("g").data(m).enter().append("svg").attr("class","box").attr("width",d/m.length).attr("height",e+analytics.margin.bottom+analytics.margin.top).append("g").attr("transform","translate("+(d/m.length/2-n/2)+","+analytics.margin.top+")").call(o)},hovPlot:function(){},parallelsPlot:function(a){function b(a){return t(e.map(function(b){return[r(b),s[b](a[b])]}))}function c(){var a=e.filter(function(a){return!s[a].brush.empty()}),b=a.map(function(a){return s[a].brush.extent()});n.classed("fade",function(c){return!a.every(function(a,d){return b[d][0]<=c[a]&&c[a]<=b[d][1]})})}var d=d3.select(a.selector);$(a.selector).empty();var e=[],f=[],g=new Object,h=d3.csv.parse(a.data);for(i=0;i<h.length;i++){var j=$.map(h[i],function(a){return[a]});-1==f.indexOf(j[0])&&f.push(j[0])}for(i=0;i<h.length;i++)$.each(h[i],function(a,b){"undefined"==typeof g[a]||null==g[a]?g[a]=[parseFloat(b)]:g[a].push(parseFloat(b))});var k=(h.length,0),l=h[0];for(var m in l)0!=k?e.push(m):k=1;var n,o=f,p=$(a.selector).width()-analytics.margin.left-analytics.margin.right,q=$(a.selector).height()-analytics.margin.top-analytics.margin.bottom,r=d3.scale.ordinal().domain(e).rangePoints([0,p]),s={},t=d3.svg.line(),u=d3.svg.axis().orient("left"),v=d.append("svg:svg").attr("class","svg").attr("display","block").attr("width","100%").attr("height","100%").append("svg:g").attr("transform","translate("+analytics.margin.left+","+analytics.margin.top+")");console.log(g),e.forEach(function(a){console.log(a,d3.min(g[a]),d3.max(g[a])),s[a]=d3.scale.linear().domain([d3.min(g[a]),d3.max(g[a])]).range([q,0]),s[a].brush=d3.svg.brush().y(s[a]).on("brush",c)});var w=d3.scale.category10().domain(f),x=v.selectAll("g.legend").data(o).enter().append("svg:g").attr("class","legend").attr("transform",function(a,b){return"translate(0,"+(20*b+584)+")"});x.append("svg:line").attr("class",String).attr("x2",8).attr("stroke",function(a){return w(a)}),x.append("svg:text").attr("x",12).attr("dy",".31em").text(function(a){return"Item "+a}),n=v.append("svg:g").attr("class","foreground").selectAll("path").data(h).enter().append("svg:path").attr("d",b).attr("stroke",function(a){var b=$.map(a,function(a){return[a]});return w(b[0])}).attr("class",function(a){var b=$.map(a,function(a){return[a]});return b[0]});var y=v.selectAll(".trait").data(e).enter().append("svg:g").attr("class","trait").attr("transform",function(a){return"translate("+r(a)+")"});y.append("svg:g").attr("class","axis").each(function(a){d3.select(this).call(u.scale(s[a]))}).append("svg:text").attr("text-anchor","middle").attr("y",-9).text(String),y.append("svg:g").attr("class","brush").each(function(a){d3.select(this).call(s[a].brush)}).selectAll("rect").attr("x",-8).attr("width",16)}};